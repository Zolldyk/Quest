"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[777],{13777:(e,s,t)=>{t.r(s),t.d(s,{default:()=>p});var l=t(95155),a=t(12115),r=t(49112),n=t(5500),i=t(28960),o=t(29675),d=t(27305),c=t(82771),m=t(26884),u=t(10184),x=t(98359),g=t(45125),h=t(80749),b=t(95999);function p(){var e;let s=(0,r.UD)(),{stakingPool:t,questManager:m,nftMinter:u}=(0,x.n)(),[p,v]=(0,a.useState)(null),[N,y]=(0,a.useState)("overview"),[S,k]=(0,a.useState)(!0),[C,A]=(0,a.useState)([]),q=(0,a.useMemo)(()=>{let e=!!(t.contract&&m.contract&&u.contract);return console.log("\uD83D\uDCCA UserDashboard: Contracts ready status:",{ready:e,stakingPool:!!t.contract,questManager:!!m.contract,nftMinter:!!u.contract,address:s}),e},[t.contract,m.contract,u.contract,s]),D=[{id:"overview",name:"Overview",icon:n.A},{id:"staking",name:"Staking",icon:i.A},{id:"quests",name:"Quest History",icon:o.A,count:null==p?void 0:p.questsCompleted},{id:"nfts",name:"NFT Badges",icon:d.A,count:null==p?void 0:p.nftBadges}];return(0,a.useEffect)(()=>{(async()=>{if(!s){v(null),A([]),k(!1);return}if(!q){console.warn("\uD83D\uDCCA UserDashboard: Contracts not yet available, skipping data fetch"),k(!1);return}k(!0);try{console.log("\uD83D\uDCCA UserDashboard: Starting data fetch for address:",s);let[e,l,a]=await Promise.allSettled([t.getStakerInfo(s).catch(e=>(console.warn("Failed to fetch staker info:",e),null)),m.getPlayerSubmissions(s).catch(e=>(console.warn("Failed to fetch user submissions:",e),[])),u.getUserBadges(s).catch(e=>(console.warn("Failed to fetch user badges:",e),[]))]),r="fulfilled"===e.status?e.value:null,n="fulfilled"===l.status?l.value:[],i="fulfilled"===a.status?a.value:[];console.log("\uD83D\uDCCA UserDashboard: Raw data fetched",{stakerInfo:!!r,submissionIdsCount:(null==n?void 0:n.length)||0,userBadgesCount:(null==i?void 0:i.length)||0});let o=[];n&&n.length>0&&(console.log("\uD83D\uDCCA UserDashboard: Processing all submissions for stats:",n.length),o=(await Promise.allSettled(n.map(e=>m.getSubmission(Number(e)).catch(s=>(console.warn("Failed to fetch submission ".concat(e,":"),s),null))))).filter(e=>"fulfilled"===e.status&&null!==e.value).map(e=>e.value),console.log("\uD83D\uDCCA UserDashboard: Successfully processed submissions:",{totalIds:n.length,validSubmissions:o.length,submissionStatuses:o.map(e=>{var s;return{id:null==(s=e.questId)?void 0:s.toString(),status:e.status}})})),A(o.slice(-5));let d=o.filter(e=>1===e.status).length,c=o.filter(e=>0===e.status).length,g=0;try{for(let e of o.filter(e=>1===e.status)){let s=await m.getQuest(Number(e.questId));(null==s?void 0:s.rewardAmount)&&(g+=Number((0,x.NJ)(s.rewardAmount,6,6)))}}catch(e){console.warn("Error calculating total earned amount:",e),g=+d}console.log("\uD83D\uDCCA UserDashboard: Calculated stats",{validSubmissions:o.length,completedCount:d,pendingCount:c,totalEarnedAmount:g,submissionDetails:o.map(e=>{var s,t;return{questId:null==(s=e.questId)?void 0:s.toString(),status:e.status,submitTime:null==(t=e.submitTime)?void 0:t.toString()}})});let h={totalStaked:(0,x.NJ)((null==r?void 0:r.stakedAmount)||BigInt(0),6),totalEarned:g.toString(),questsCompleted:d,nftBadges:(null==i?void 0:i.length)||0,pendingSubmissions:c};console.log("\uD83D\uDCCA UserDashboard: Final dashboard stats",h),v(h)}catch(e){console.error("Error fetching dashboard data:",e),v({totalStaked:"0",totalEarned:"0",questsCompleted:0,nftBadges:0,pendingSubmissions:0}),A([])}finally{k(!1)}})()},[s,q]),(0,l.jsx)("div",{className:"space-y-6",children:S?(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,l.jsx)(g.Qv,{},s))}),(0,l.jsx)(g.Qv,{})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 md:gap-6 mb-6",children:[(0,l.jsx)(f,{title:"Total Staked",value:"".concat((null==p?void 0:p.totalStaked)||"0"," USDC"),icon:(0,l.jsx)(i.A,{className:"h-4 w-4 sm:h-5 sm:w-5 text-blue-600"}),bgColor:"bg-blue-50",textColor:"text-blue-600"}),(0,l.jsx)(f,{title:"Total Earned",value:"".concat((null==p?void 0:p.totalEarned)||"0"," USDC"),icon:(0,l.jsx)(o.A,{className:"h-4 w-4 sm:h-5 sm:w-5 text-green-600"}),bgColor:"bg-green-50",textColor:"text-green-600"}),(0,l.jsx)(f,{title:"Quests Submitted",value:(((null==p?void 0:p.questsCompleted)||0)+((null==p?void 0:p.pendingSubmissions)||0)).toString(),icon:(0,l.jsx)(n.A,{className:"h-4 w-4 sm:h-5 sm:w-5 text-purple-600"}),bgColor:"bg-purple-50",textColor:"text-purple-600"}),(0,l.jsx)(f,{title:"Pending Review",value:(null==p||null==(e=p.pendingSubmissions)?void 0:e.toString())||"0",icon:(0,l.jsx)(c.A,{className:"h-4 w-4 sm:h-5 sm:w-5 text-yellow-600"}),bgColor:"bg-yellow-50",textColor:"text-yellow-600"})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-card border border-gray-200 overflow-hidden",children:[(0,l.jsx)("div",{className:"border-b border-gray-200",children:(0,l.jsx)("nav",{className:"flex flex-wrap sm:space-x-8 px-4 sm:px-6 overflow-x-auto","aria-label":"Tabs",children:D.map(e=>(0,l.jsxs)("button",{onClick:()=>y(e.id),className:"\n                        flex items-center py-3 sm:py-4 px-2 sm:px-1 border-b-2 font-medium text-xs sm:text-sm transition-colors whitespace-nowrap\n                        ".concat(N===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","\n                      "),children:[(0,l.jsx)(e.icon,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2 flex-shrink-0"}),(0,l.jsx)("span",{className:"hidden sm:inline",children:e.name}),(0,l.jsx)("span",{className:"sm:hidden",children:e.name.split(" ")[0]}),void 0!==e.count&&e.count>0&&(0,l.jsx)("span",{className:"\n                          ml-1 sm:ml-2 py-0.5 px-1.5 sm:px-2 rounded-full text-xs font-medium\n                          ".concat(N===e.id?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600","\n                        "),children:e.count})]},e.id))})}),(0,l.jsxs)("div",{className:"p-4 sm:p-6",children:["overview"===N&&(0,l.jsx)(j,{stats:p,recentSubmissions:C}),"staking"===N&&(0,l.jsx)(h.default,{}),"quests"===N&&(0,l.jsx)(b.default,{}),"nfts"===N&&(0,l.jsx)(w,{})]})]})]})})}function f(e){let{title:s,value:t,icon:a,bgColor:r,textColor:n}=e;return(0,l.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-4",children:(0,l.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[(0,l.jsx)("div",{className:"".concat(r," p-1.5 sm:p-2 rounded-lg flex-shrink-0"),children:a}),(0,l.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,l.jsx)("p",{className:"text-xs sm:text-sm font-medium text-gray-600 truncate",children:s}),(0,l.jsx)("p",{className:"text-sm sm:text-lg lg:text-xl font-bold ".concat(n," truncate"),children:t})]})]})})}function j(e){let{stats:s,recentSubmissions:t}=e;return(0,l.jsxs)("div",{className:"space-y-8",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:[(0,l.jsx)(v,{title:"Stake USDC",description:"Fund the quest reward pool",href:"/staking",icon:(0,l.jsx)(i.A,{className:"h-4 w-4 sm:h-5 sm:w-5"}),color:"blue"}),(0,l.jsx)(v,{title:"Browse Quests",description:"Find new quests to complete",href:"/quests",icon:(0,l.jsx)(o.A,{className:"h-4 w-4 sm:h-5 sm:w-5"}),color:"green"}),(0,l.jsx)(v,{title:"View NFTs",description:"See your earned badges",href:"#",onClick:()=>{},icon:(0,l.jsx)(d.A,{className:"h-4 w-4 sm:h-5 sm:w-5"}),color:"purple"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Activity"}),t.length>0&&(0,l.jsx)("button",{className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"View All"})]}),(0,l.jsx)("div",{className:"space-y-3",children:0===t.length?(0,l.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,l.jsx)(m.A,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),(0,l.jsx)("p",{children:"No recent activity"}),(0,l.jsx)("p",{className:"text-sm",children:"Complete your first quest to get started!"})]}):t.map((e,s)=>(0,l.jsx)(N,{submission:e},s))})]}),s&&(0,l.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Account Summary"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:s.totalStaked}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"USDC Staked"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-green-600",children:s.totalEarned}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"USDC Earned"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:s.questsCompleted}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Quests Done"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:s.nftBadges}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"NFT Badges"})]})]})]})]})}function v(e){let{title:s,description:t,href:a,onClick:r,icon:n,color:i}=e;return(0,l.jsxs)(a?"a":"button",{...a?{href:a}:{onClick:r},className:"\n        block p-3 sm:p-4 border-2 rounded-lg transition-colors hover:bg-gray-50\n        ".concat({blue:"border-blue-200 hover:border-blue-300 text-blue-600",green:"border-green-200 hover:border-green-300 text-green-600",purple:"border-purple-200 hover:border-purple-300 text-purple-600"}[i],"\n      "),children:[(0,l.jsxs)("div",{className:"flex items-center mb-2",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:n}),(0,l.jsx)("h4",{className:"ml-2 font-medium text-gray-900 text-sm sm:text-base truncate",children:s})]}),(0,l.jsx)("p",{className:"text-xs sm:text-sm text-gray-600",children:t})]})}function N(e){let{submission:s}=e;return(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(o.A,{className:"h-5 w-5 text-gray-400 mr-3"}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"font-medium text-gray-900",children:["Quest #",s.questId.toString()]}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["Submitted ",new Date(1e3*Number(s.submitTime)).toLocaleDateString()]})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)("span",{className:"\n          px-2 py-1 rounded-full text-xs font-medium\n          ".concat((e=>{switch(e){case 0:return"text-yellow-600 bg-yellow-50";case 1:return"text-green-600 bg-green-50";case 2:return"text-red-600 bg-red-50";default:return"text-gray-600 bg-gray-50"}})(s.status),"\n        "),children:(e=>{switch(e){case 0:return"Pending";case 1:return"Completed";case 2:return"Rejected";default:return"Unknown"}})(s.status)}),(0,l.jsx)("button",{className:"text-gray-400 hover:text-gray-600",children:(0,l.jsx)(u.A,{className:"h-4 w-4"})})]})]})}function w(){return(0,l.jsxs)("div",{className:"text-center py-8",children:[(0,l.jsx)(d.A,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"NFT Badges"}),(0,l.jsx)("p",{className:"text-gray-600 mb-4",children:"Your earned quest badges will appear here"})]})}}}]);